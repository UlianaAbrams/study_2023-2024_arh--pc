---
## Front matter
title: "Отчёт по лабораторной работе №6"
subtitle: "Дисциплина: Архитектура компьютера"
author: "Абрамова Ульяна Михайловна"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
listingTitle: "Листинги"
lofTitle: "Список иллюстраций"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Цель данной лабораторной работы - освоение арифметческих инструкций языка ассемблера NASM.

# Задание

1. Символьные и численные данные в NASM
2. Выполненение арифметических операций в NASM
3. Выполнение заданий для самостоятельной работы

# Теоретическое введение

Большинство инструкций на языке ассемблера требуют обработки операндов. Адрес операнда предоставляет место, где хранятся данные, подлежащие обработке. Это могут быть данные хранящиеся в регистре или в ячейке памяти.

  - Регистровая адресация – операнды хранятся в регистрах и в команде используются имена этих регистров, например: mov ax,bx.
  - Непосредственная адресация – значение операнда задается непосредственно в команде, Например: mov ax,2.
  - Адресация памяти – операнд задает адрес в памяти. В команде указывается символическое обозначение ячейки памяти, над содержимым которой требуется выполнить операцию.

Ввод информации с клавиатуры и вывод её на экран осуществляется в символьном виде. Кодирование этой информации производится согласно кодовой таблице символов ASCII. ASCII – сокращение от American Standard Code for Information Interchange (Американский стандартный код для обмена информацией). Согласно стандарту ASCII каждый символ кодируется одним байтом. Среди инструкций NASM нет такой, которая выводит числа (не в символьном виде). Поэтому, например, чтобы вывести число, надо предварительно преобразовать его цифры в ASCII-коды этих цифр и выводить на экран эти коды, а не само число. Если же выводить число на экран непосредственно, то экран воспримет его не как число, а как последовательность ASCII-символов – каждый байт числа будет воспринят как один ASCII-символ – и выведет на экран эти символы. Аналогичная ситуация происходит и при вводе данных с клавиатуры. Введенные данные будут представлять собой символы, что сделает невозможным получение корректного результата при выполнении над ними арифметических операций. Для решения этой проблемы необходимо проводить преобразование ASCII символов в числа и обратно

# Выполнение лабораторной работы
## Символьные и численные данные в NASM
С помощью утилиты mkdir создаю директорию, в которой буду создавать файлы с программами для лабораторной работы №6. Перехожу в созданный каталог с помощью утилиты cd. Благодаря утилиту touch создаю файл lab6-1.asm 
(рис. [-@fig:fig1]).

![Создание файлов](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/a.jpeg){#fig:fig1 width=70%}

Открываю созданный файл lab6-1.asm, вставляю в него программу вывода значения регистра eax (рис. [-@fig:fig2]).

![Написание программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/b.jpeg){#fig:fig2 width=70%}

Создаю исполняемый файл программы и запускаю его (рис. [-@fig:fig3]). 
Вывод программы: символ j, потому что программа вывела символ, соответствующий по системе ASCII сумме двоичных кодов символов 4 и 6.

![Запуск программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/c.jpeg){#fig:fig3 width=80%}

Изменяю в тексте программы символы '6' и '4' на цифры 6 и 4 (рис. [-@fig:fig4]).

![Изменение текста программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/d.jpeg){#fig:fig4 width=70%}

Создаю новый исполняемый файл программы и запускаю его (рис. [-@fig:fig5]). Теперь вывелся символ с кодом 10, это символ перевода строки, этот символ не отображается при выводе на экран.

![Создание файла программы и его запуск](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/e.jpeg){#fig:fig5 width=80%}

Создаю новый файл lab6-2.asm с помощью утилиты touch и ввожу в него текст другой программы для вывода значения регистра eax (рис. [-@fig:fig6]).

![Написание программы в новом созданном файле](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/f.jpeg){#fig:fig6 width=70%}

Создаю и запускаю исполняемый файл lab6-2.
Теперь выводится число 106, потому что программа позволяет вывести именно число, а не символ, хотя все еще происходит сложение кодов символов '6' и '4'. (рис. [-@fig:fig7]).

![Создание и запуск файла программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/g.jpeg){#fig:fig7 width=80%}

Заменяю в тексте программы в файле lab6-2.asm символы '6' и '4' на числа 6 и 4 (рис. [-@fig:fig8]).

![Изменение текста программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/h.jpeg){#fig:fig8 width=70%}

Создаю и запускаю новый исполняемый файл. 
Теперь программа складывает не соответствующие символам коды в системе ASCII, а сами числа, поэтому выводится 10 (рис. [-@fig:fig9]).

![Создание и запуск файла программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/j.jpeg){#fig:fig9 width=80%}

Заменяю в тексте программы функцию iprintLF на iprint (рис. [-@fig:fig10]).

![Изменение текста программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/k.jpeg){#fig:fig10 width=70%}

Создаю и запускаю новый исполняемый файл. 
Вывод не изменился, потому что символ переноса строки не отображался, когда программа исполнялась с функцией iprintLF, а iprint не добавляет к выводу символ переноса строки, в отличие от iprintLF (рис. [-@fig:fig11]).

![Создпние и запуск файла программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/l.jpeg){#fig:fig11 width=80%}

## Выполнение арифметических операций в NASM
Создаю файл lab6-3.asm с помощью утилиты touch и ввожу в него текст программы для вычисления значения выражения f(x) = (5 * 2 + 3)/3 (рис. [-@fig:fig12]).

![Написание программы в новом созданном файле](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/m.jpeg){#fig:fig12 width=70%}

Создаю исполняемый файл и запускаю его (рис. [-@fig:fig13]).

![Создание и запуск файла программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/n.jpeg){#fig:fig13 width=80%}

Изменяю программу так, чтобы она вычисляла значение выражения f(x) = (4 * 6 + 2)/5 (рис. [-@fig:fig14]).

![Изменение текста программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/o.jpeg){#fig:fig14 width=70%}

Создаю и запускаю новый исполняемый файл. Я посчитала для проверки правильности работы программы значение выражения самостоятельно, программа отработала верно. (рис. [-@fig:fig15])

![Создание и запуск файла программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/p.jpeg){#fig:fig15 width=80%}

Создаю файл variant.asm с помощью утилиты touch и ввожу в него текст программы для вычисления варианта задания по номеру студенческого билета 
(рис. [-@fig:fig16]).

![Написание программы в новом созданном файле](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/q.jpeg){#fig:fig16 width=70%}

Создаю и запускаю исполняемый файл. Ввожу номер своего студ. билета с клавиатуры, программа вывела, что мой вариант - 3 (рис. [-@fig:fig17]).

![Cоздание и запуск файла программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/r.jpeg){#fig:fig17 width=80%}

## Ответы на вопросы по программе
1. За вывод сообщения "Ваш вариант" отвечают строки кода:
``` language
mov eax,rem
call sprint
```

2. Инструкция mov ecx, x используется, чтобы положить адрес вводимой строки x в регистр ecx mov edx, 80 - запись в регистр edx длины вводимой строки call sread - вызов подпрограммы из внешнего файла, обеспечивающей ввод сообщения с клавиатуры

3. call atoi используется для вызова подпрограммы из внешнего файла, которая преобразует ascii-код символа в целое число и записывает результат в регистр eax

4. За вычисления варианта отвечают строки:
``` language
xor edx,edx ; обнуление edx для корректной работы div
mov ebx,20 ; ebx = 20
div ebx ; eax = eax/20, edx - остаток от деления
inc edx ; edx = edx + 1
```

5. При выполнении инструкции div ebx остаток от деления записывается в регистр edx

6. Инструкция inc edx увеличивает значение регистра edx на 1

7. За вывод на экран результатов вычислений отвечают строки:
``` language
mov eax,edx
call iprintLF
```

## Выполнение заданий для самостоятельной работы
Создаю файл lab7-4.asm с помощью утилиты touch, открываю его для редактирования, ввожу в него текст программы для вычисления значения выражения (х+2)^2 , которое было под вариантом 3 (рис. [-@fig:fig18]). 

![Написание программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/s.jpeg){#fig:fig18 width=60%}

Создаю и запускаю исполняемый файл. При вводе значения на входе 2, вывод - 16. Провожу еще один запуск исполняемого файла для проверки работы программы, но с другим значением равным 8, вывод - 100. Что показывает верную отработку программы (рис. [-@fig:fig19]).

![Создание, запуск и проверка корректности программы](/home/uliana_abramova/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/t.jpeg){#fig:fig19 width=80%}



Программа для вычисления значения выражения (х+2)^2 :
``` language
%include 'in_out.asm' ; подключение внешнего файла
SECTION .data ; секция инициированных данных
msg: DB 'Введите значение переменной х: ',0
rem: DB 'Результат: ',0
SECTION .bss ; секция не инициированных данных
x: RESB 80 ; Переменная, значение к-рой будем вводить с клавиатуры, выделенный размер - 80 байт
SECTION .text ; Код программы
GLOBAL _start ; Начало программы
_start: ; Точка входа в программу
; ---- Вычисление выражения
mov eax, msg ; запись адреса выводимиого сообщения в eax
call sprint ; вызов подпрограммы печати сообщения
mov ecx, x ; запись адреса переменной в ecx
mov edx, 80 ; запись длины вводимого значения в edx
call sread ; вызов подпрограммы ввода сообщения
mov eax,x ; вызов подпрограммы преобразования
call atoi ; ASCII кода в число, `eax=x`
add eax,2; eax = eax+2 = x + 2
mov ebx,eax ; запись значения eax в регистр ebx
mul ebx; EAX=EAX*EBX = (x+2)^2
mov edi,eax ; запись результата вычисления в 'edi'
; ---- Вывод результата на экран
mov eax,rem ; вызов подпрограммы печати
call sprint ; сообщения 'Результат: '
mov eax,edi ; вызов подпрограммы печати значения
call iprint ; из 'edi' в виде символов
call quit ; вызов подпрограммы завершения
```

# Выводы

При выполнении данной лабораторной работы я освоила арифметические инструкции языка ассемблера NASM.

# Список литературы
1. [Архитектура ЭВМ](https://esystem.rudn.ru/pluginfile.php/2089542/mod_resource/content//%D0%9B%D0%B0%D0%B1%D0%BE%D1%80%D0%B0%D1%82%D0%BE%D1%80%D0%BD%D0%B0%D1%8F%20%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%20%E2%84%966.%20%D0%90%D1%80%D0%B8%D1%84%D0%BC%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5%20%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B2%20NASM..pdf)
2. [Таблица ASCII](https://www.rapidtables.com/code/text/ascii-table.html)
